// ============================================================================
// ๐ค ูุงุฌูุฉ ุณุทุฑ ุงูุฃูุงูุฑ ูููููู ุงูุฐูู - Agent CLI
// ============================================================================
// ุจุฑูุงูุฌ ุชูุงุนูู ููุชูุงุนู ูุน ูููู ุงูุจูุงู

use agent;

// ============================================================================
// ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู
// ============================================================================

fn main() -> int {
    // ุฅูุดุงุก ุงูุฅุนุฏุงุฏุงุช
    let config = agent::create_config("ar", false);

    // ุฅูุดุงุก ุงููููู
    let mut agent = agent::create_agent(config);

    // ุฅูุดุงุก ุฌุณุฑ ุงูุชูุงูู
    let bridge = agent::create_bridge("target/debug/albayan", ".");

    // ุทุจุงุนุฉ ุฑุณุงูุฉ ุงูุชุฑุญูุจ
    print(agent::get_welcome_message(agent));
    print("\n");

    // ุงูุญููุฉ ุงูุฑุฆูุณูุฉ
    loop {
        // ุทุจุงุนุฉ ุงูุฏุนูุฉ
        print("> ");

        // ูุฑุงุกุฉ ุงูุฅุฏุฎุงู
        let input = read_line();

        // ุงูุชุญูู ูู ุฃูุงูุฑ ุงูุฎุฑูุฌ
        if input == "exit" || input == "quit" || input == "ุฎุฑูุฌ" {
            print(agent::get_goodbye_message(agent));
            print("\n");
            break;
        }

        // ุงูุชุญูู ูู ุงูุฃูุงูุฑ ุงูุฎุงุตุฉ
        if input == "help" || input == "ูุณุงุนุฏุฉ" {
            print(agent::nlg::generate_help_message(agent.config.language));
            print("\n");
            continue;
        }

        if input == "status" || input == "ุญุงูุฉ" {
            print(agent::optimizer::get_event_summary(agent));
            print("\n");
            continue;
        }

        if input == "reset" || input == "ุฅุนุงุฏุฉ ุชุนููู" {
            agent::optimizer::reset_events(agent);
            print("โ ุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุฃุญุฏุงุซ\n");
            continue;
        }

        if input == "lang" || input == "ุงููุบุฉ" {
            if agent.config.language == "ar" {
                agent.config.language = "en";
                print("โ ุชู ุชุบููุฑ ุงููุบุฉ ุฅูู ุงูุฅูุฌููุฒูุฉ\n");
            } else {
                agent.config.language = "ar";
                print("โ ุชู ุชุบููุฑ ุงููุบุฉ ุฅูู ุงูุนุฑุจูุฉ\n");
            }
            continue;
        }

        // ูุนุงูุฌุฉ ุงูุฅุฏุฎุงู ุงูุนุงุฏู
        if input.len() > 0 {
            let response = agent::process_input(agent, input, bridge);
            print(response.text);
            print("\n");

            // ุทุจุงุนุฉ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ุฅู ูุฌุฏุช
            if response.data.len() > 0 {
                let i = 0;
                while i < response.data.len() {
                    print("  - ");
                    print(response.data[i]);
                    print("\n");
                    i = i + 1;
                }
            }
        }
    }

    return 0;
}

// ============================================================================
// ุฏุงูุฉ ูุณุงุนุฏุฉ ููุฑุงุกุฉ ุงูุณุทุฑ
// ============================================================================

fn read_line() -> string {
    // ูุฐู ุฏุงูุฉ ูุฏูุฌุฉ ูู ุงูุจูุงู
    // ุชูุฑุฃ ุณุทุฑุงู ูู ุงูุฅุฏุฎุงู ุงูููุงุณู
    return "";
}

// ============================================================================
// ููุงูุฉ ุงูุจุฑูุงูุฌ
// ============================================================================

